<joblist>
  <job>
    <context>
      <options preserveOrder='true'>
        <option name='BATCH' value='20'>
          <label>Batch</label>
        </option>
        <option name='OLDER_THAN' value='1d'>
          <label>Older than</label>
        </option>
      </options>
    </context>
    <defaultTab>nodes</defaultTab>
    <description></description>
    <executionEnabled>true</executionEnabled>
    <group>cleanup/rundeck</group>
    <id>e915dd09-294b-482c-9ee4-b1e42bf9f8a1</id>
    <loglevel>INFO</loglevel>
    <name>Cleanup Rundeck executions</name>
    <nodeFilterEditable>false</nodeFilterEditable>
    <schedule>
      <month month='*' />
      <time hour='0/3' minute='0' seconds='0' />
      <weekday day='*' />
      <year year='*' />
    </schedule>
    <scheduleEnabled>true</scheduleEnabled>
    <sequence keepgoing='false' strategy='node-first'>
      <command>
        <script><![CDATA[#!/bin/bash -e
# https://gist.github.com/shamil/1f6524f06210252c7d13d0deb169bdc2

. ~/projects/@job.project@/scripts/rd-setup.sh
# export RD_URL=http://localhost:4440
# export RD_USER=username
# export RD_PASSWORD=password
# export RD_HTTP_TIMEOUT=300

while true; do
    rd executions deletebulk -R -y -m ${RD_OPTION_BATCH:-20} --older ${RD_OPTION_OLDER_THAN:-1d} -p satsuki || break
    sleep 1s
done

exit 0
]]></script>
        <scriptargs />
      </command>
    </sequence>
    <timeZone>Asia/Tokyo</timeZone>
    <uuid>e915dd09-294b-482c-9ee4-b1e42bf9f8a1</uuid>
  </job>
</joblist>
